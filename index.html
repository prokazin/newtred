<!doctype html>
<html lang="ru">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
  <title>Trading Game — Telegram</title>

  <link rel="stylesheet" href="css/style.css" />
  <!-- Chart.js CDN -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>

  <!-- Telegram Web App JS (используется внутри Telegram) -->
  <script src="https://telegram.org/js/telegram-web-app.js"></script>
</head>
<body>
  <div id="app">
    <header>
      <div class="brand">
        <img src="assets/icon-btc.png" alt="logo" class="logo">
        <div>
          <h1>Crypto Trading — Demo</h1>
          <p class="slogan">3 монеты • плечо 2x/5x/10x • мобильная версия</p>
        </div>
      </div>
      <div class="balance-box">
        <div>Баланс: <span id="balanceDisplay">—</span>$</div>
        <div>Свободно: <span id="freeDisplay">—</span>$</div>
      </div>
    </header>

    <!-- Tabs -->
    <nav class="tabs">
      <button class="tab-btn active" data-tab="dashboard">Дашборд</button>
      <button class="tab-btn" data-tab="trade">Торговля</button>
      <button class="tab-btn" data-tab="history">История</button>
      <button class="tab-btn" data-tab="ranking">Рейтинг</button>
      <button class="tab-btn" data-tab="settings">Настройки</button>
    </nav>

    <main>
      <!-- DASHBOARD -->
      <section id="dashboard" class="tab active">
        <div class="market-grid">
          <!-- cards for 3 coins -->
          <div class="coin-card" data-coin="BTC">
            <div class="coin-header">
              <img src="assets/icon-btc.png" alt="">
              <div>
                <div class="coin-name">BTC</div>
                <div class="coin-price" id="price-BTC">— $</div>
              </div>
              <div class="coin-change" id="change-BTC">—</div>
            </div>
            <canvas id="chart-BTC" class="mini-chart"></canvas>
            <div class="mini-controls">
              <button class="open-trade" data-coin="BTC">Торговать</button>
              <div class="entry-info" id="entry-BTC">Нет позиций</div>
            </div>
          </div>

          <div class="coin-card" data-coin="ETH">
            <div class="coin-header">
              <img src="assets/icon-eth.png" alt="">
              <div>
                <div class="coin-name">ETH</div>
                <div class="coin-price" id="price-ETH">— $</div>
              </div>
              <div class="coin-change" id="change-ETH">—</div>
            </div>
            <canvas id="chart-ETH" class="mini-chart"></canvas>
            <div class="mini-controls">
              <button class="open-trade" data-coin="ETH">Торговать</button>
              <div class="entry-info" id="entry-ETH">Нет позиций</div>
            </div>
          </div>

          <div class="coin-card" data-coin="XRP">
            <div class="coin-header">
              <img src="assets/icon-xrp.png" alt="">
              <div>
                <div class="coin-name">XRP</div>
                <div class="coin-price" id="price-XRP">— $</div>
              </div>
              <div class="coin-change" id="change-XRP">—</div>
            </div>
            <canvas id="chart-XRP" class="mini-chart"></canvas>
            <div class="mini-controls">
              <button class="open-trade" data-coin="XRP">Торговать</button>
              <div class="entry-info" id="entry-XRP">Нет позиций</div>
            </div>
          </div>
        </div>

        <div class="position-panel">
          <h3>Активная позиция</h3>
          <div id="activePosition">
            Нет открытой позиции.
          </div>
        </div>
      </section>

      <!-- TRADE -->
      <section id="trade" class="tab">
        <div class="trade-container">
          <div class="trade-left">
            <div class="trade-select">
              <label>Монета:
                <select id="tradeCoin">
                  <option value="BTC">BTC</option>
                  <option value="ETH">ETH</option>
                  <option value="XRP">XRP</option>
                </select>
              </label>

              <label>Плечо:
                <select id="leverage">
                  <option value="2">2x</option>
                  <option value="5">5x</option>
                  <option value="10">10x</option>
                </select>
              </label>
            </div>

            <div class="trade-params">
              <label>Маржа (из баланса $): <input type="number" id="marginInput" min="1" step="1" value="10"></label>
              <label>Тип: 
                <select id="side">
                  <option value="long">Long</option>
                  <option value="short">Short</option>
                </select>
              </label>

              <!-- Убрали Stop-loss по запросу -->
              <label>Take-profit ($, optional): <input type="number" id="takeInput" placeholder="Цена тейк"></label>

              <div class="trade-actions">
                <button id="openBtn" class="btn-primary">Открыть позицию</button>
                <button id="closeBtn" class="btn-danger" disabled>Закрыть позицию</button>
              </div>
            </div>
          </div>

          <div class="trade-right">
            <h4>График</h4>
            <canvas id="bigChart"></canvas>
            <div class="pnl-box">
              <div>Тек. P&L: <span id="pnl">—</span>$</div>
              <div>Риск/ликвидация: <span id="liq">—</span></div>
            </div>
          </div>
        </div>
      </section>

      <!-- HISTORY -->
      <section id="history" class="tab">
        <h3>История сделок</h3>
        <div id="historyList" class="history-list"></div>
      </section>

      <!-- RANKING -->
      <section id="ranking" class="tab">
        <h3>Рейтинг игроков</h3>
        <div id="rankingList" class="ranking-list"></div>
      </section>

      <!-- SETTINGS -->
      <section id="settings" class="tab">
        <h3>Настройки</h3>
        <label>Начальный баланс: <input id="startBalance" type="number" value="1000"></label>
        <div class="settings-actions">
          <button id="resetBtn" class="btn-danger">Сбросить игру (стереть localStorage)</button>
          <button id="applyBalanceBtn" class="btn-primary">Применить баланс</button>
        </div>
        <p class="note">Игра — симуляция. Данные хранятся только в вашем браузере.</p>
      </section>
    </main>

    <footer>
      <small>Сделано для телеграм-игры · Клиентская симуляция · Размещайте на GitHub Pages</small>
    </footer>
  </div>

  <script src="js/app.js"></script>
</body>
</html>
